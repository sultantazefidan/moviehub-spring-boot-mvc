<!DOCTYPE html>
<html lang="tr" xmlns:th="http://www.thymeleaf.org">
<head>

    <meta charset="UTF-8">
    <title>Film Y√∂netimi</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
          rel="stylesheet">

    
    <link rel="stylesheet" th:href="@{/css/header.css}">

    
    <link rel="stylesheet" th:href="@{/css/manage.css}">
</head>


<body>
<!--  Ba≈üarƒ± mesajƒ± (silme sonrasƒ±) -->
<div th:if="${successMessage}"
     class="alert alert-success alert-dismissible fade show"
     style="
       max-width: 640px;
       margin: 14px auto;
       padding: 10px 42px 10px 16px;
       text-align: center;
       font-weight: 600;
       border-radius: 12px;
       position: relative;
     ">

  <span th:text="${successMessage}"></span>

  <button type="button"
          class="btn-close"
          data-bs-dismiss="alert"
          style="
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%) scale(0.85);
          ">
  </button>

</div>


<div class="container mt-1 manage-page">


    <!-- Bilgi kutusu -->
    <div id="infoBox"
         style="
           background:#eef7ff;
           border:1px solid #cce5ff;
           padding:8px 35px 8px 12px;
           margin:10px 0;
           font-size:14px;
           position:relative;
           display:none;
         ">
        ‚ÑπÔ∏è Bir film √ºzerinde deƒüi≈üiklik yapmak i√ßin, film listesindeki
        <strong>‚ÄúD√ºzenle‚Äù</strong> butonunu kullanabilirsiniz.

        <span onclick="hideInfoBox()"
              title="Kapat"
              style="
                position:absolute;
                top:6px;
                right:10px;
                cursor:pointer;
                font-size:16px;
                color:#555;
              ">
            ‚úñ
        </span>
    </div>
    
    <div class="manage-hint">
  <span>
 ‚ÑπÔ∏è Bu ekran yalnƒ±zca film <strong>d√ºzenleme</strong> ve <strong>silme</strong> i≈ülemleri i√ßin kullanƒ±lƒ±r.
 Ana sayfada film g√∂r√ºnt√ºleme ve se√ßim yapabilirsiniz.
</span>


  <a th:href="@{/}" class="btn btn-outline-secondary btn-sm">
  ‚Üê Ana Sayfaya D√∂n
</a>

</div>
    

    <h2 class="mb-3"> ‚öôÔ∏è Film Y√∂netimi </h2>

    <!-- Hi√ß film yoksa -->
    <div th:if="${#lists.isEmpty(movies)}" class="alert alert-info">
        Hen√ºz film eklenmedi.
    </div>

    <!-- Tablo -->
    <div class="table-responsive">
  <table class="table table-striped table-hover align-middle">

        <thead class="table-light">
        <tr>
            <th>Ad</th>
            <th>T√ºr</th>
            <th>Yƒ±l</th>
            <th>S√ºre</th>
            <th>A√ßƒ±klama</th>
            <th>ƒ∞zlendi</th>
            <th>Puan</th>
            <th>Not</th>
            <th>ƒ∞≈ülem</th>
            <th>G√∂rsel</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="m : ${movies}">
            <td th:text="${m.title}"></td>
            <td th:text="${#strings.listJoin(m.genres, ', ')}"></td>
            <td th:text="${m.releaseYear}"></td>

         <td style="white-space: nowrap;"
    th:text="
      ${m.duration == null} ? '-' :
      (${m.duration >= 60} ?
        (${m.duration / 60} + 's ' + (${m.duration} % 60) + 'dk') :
        (${m.duration} + 'dk')
      )
    ">
</td>



            <td class="desc-cell" th:text="${m.description} ?: '-'"></td>
            <td th:text="${m.watched ? 'Evet' : 'Hayƒ±r'}"></td>
            <td th:text="${m.watched ? m.rating : '-'}"></td>
            <td>
         <!-- ƒ∞zlendiyse: normal not -->
          <span th:if="${m.watched}"
          th:text="${m.note} ?: '-'">
           </span>

        <!-- ƒ∞zlenmediyse: silik + ƒ∞zlenecek -->
         <span th:if="${!m.watched and !#strings.isEmpty(m.note)}"
          class="note-pending">
        ƒ∞zlenecek: <span th:text="${m.note}"></span>
         </span>

         <!-- Not yoksa -->
      <span th:if="${#strings.isEmpty(m.note)}">-</span>
      </td>


            <td style="white-space: nowrap;">
                <a th:href="@{/edit/{id}(id=${m.id})}"
                   class="btn btn-warning btn-sm">‚úèÔ∏è D√ºzenle</a>

                <a th:href="@{/delete/{id}(id=${m.id})}"
                   class="btn btn-danger btn-sm"
                   onclick="return confirm('Silmek istiyor musunuz?')">üóëÔ∏è Sil</a>
            </td>

            <td>
         <img th:if="${m.imageUrl != null}"
         th:src="${m.imageUrl}"
         class="movie-poster">

       <span th:if="${m.imageUrl == null}">-</span>
     </td>

        </tr>
        </tbody>

    </table>
</div>
</div>

<script>
    function showInfoBox() {
        document.getElementById("infoBox").style.display = "block";
    }

    function hideInfoBox() {
        document.getElementById("infoBox").style.display = "none";
    }

    window.onload = function () {
        showInfoBox();
    };
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>


</body>
</html>
